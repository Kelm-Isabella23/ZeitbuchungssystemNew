{% extends "base.html" %}
{% block content %}
<h1>Dashboard</h1>


<div class="no-print" style="margin-bottom:16px;">
  {% if role == "USER" %}
    <form method="post" action="{% url 'request_vip' %}">
      {% csrf_token %}
      <button type="submit">VIP beantragen</button>
    </form>
  {% elif role == "VIP" %}
    <form method="post" action="{% url 'request_admin' %}">
      {% csrf_token %}
      <button type="submit">Administrator beantragen</button>
    </form>
  {% elif role == "ADMIN" %}
    <p>
      <a href="{% url 'admin_requests' %}">Admin: Anträge</a> |
      <a href="{% url 'admin_users' %}">Admin: Benutzer</a>
    </p>
  {% endif %}
</div>

{% if role == "VIP" or role == "ADMIN" %}
  <hr>
  <h3>VIP-Funktionen</h3>

  <p>
    Export:
    <a href="{% url 'vip_export' %}?format=json">JSON</a> |
    <a href="{% url 'vip_export' %}?format=csv">CSV</a> |
    <a href="{% url 'vip_export' %}?format=xml">XML</a>
  </p>

  <form method="post" action="{% url 'vip_import' %}" enctype="multipart/form-data">
    {% csrf_token %}
    <label>Import (überschreibt alle Reports):</label><br>
    <select name="format">
      <option value="json">JSON</option>
      <option value="csv">CSV</option>
      <option value="xml">XML</option>
    </select>
    <input type="file" name="file" required>
    <button type="submit">Importieren</button>
  </form>
{% endif %}



<p>Gesamtzeit: <b>{{ total_all }}</b> Minuten</p>

{% if total_all == 0 %}
  <p>Noch keine Berichte vorhanden.</p>
{% else %}
  <table border="1" cellpadding="6">
    <tr>
      <th>Modul</th>
      <th>Minuten</th>
      <th>Anteil (%)</th>
    </tr>
    {% for r in rows %}
      <tr>
        <td>{{ r.module }}</td>
        <td>{{ r.minutes }}</td>
        <td>{{ r.percent }}</td>
      </tr>
    {% endfor %}
  </table>
{% endif %}
{% endblock %}
